VK_VERSION=${VK_VERSION:-0.5.0}
pushd /usr/local/bin
wget https://github.com/leynos/vk/releases/download/v${VK_VERSION}/vk
chmod 777 vk
popd

uv tool install mbake
bun install -g pajv

# Tools to help developers
apt update -y
apt-get install -y \
  strace gdb \
  bat ripgrep nano ed \
  ltrace valgrind bpfcc-tools bpftrace \
  lsof htop iotop \
  ncdu tree bat delta \
  tcpdump nmap clang lldb \
  eza fzf hyperfine shellcheck \
  linux-tools-common linux-tools-generic

cargo binstall fd-find

pushd /usr/local/bin
CHECKMAKE_VERSION=${CHECKMAKE_VERSION:-0.2.2}
wget -O checkmake https://github.com/checkmake/checkmake/releases/download/${CHECKMAKE_VERSION}/checkmake-${CHECKMAKE_VERSION}.linux.amd64
chmod 755 checkmake

DIFFTASTIC_VERSION=${DIFFTASTIC_VERSION:-0.64.0}
pushd /tmp
wget https://github.com/Wilfred/difftastic/releases/download/${DIFFTASTIC_VERSION}/difft-x86_64-unknown-linux-gnu.tar.gz
popd
tar xzf /tmp/difft-x86_64-unknown-linux-gnu.tar.gz
rm -f /tmp/difft-x86_64-unknown-linux-gnu.tar.gz
popd

git config --global merge.conflictStyle zdiff3

(type -p wget >/dev/null || (apt update && apt install wget -y)) \
	&& mkdir -p -m 755 /etc/apt/keyrings \
	&& out=$(mktemp) && wget -nv -O$out https://cli.github.com/packages/githubcli-archive-keyring.gpg \
	&& cat $out > /dev/null \
	&& chmod go+r /etc/apt/keyrings/githubcli-archive-keyring.gpg \
	&& mkdir -p -m 755 /etc/apt/sources.list.d \
	&& echo "deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/githubcli-archive-keyring.gpg] https://cli.github.com/packages stable main" | sudo tee /etc/apt/sources.list.d/github-cli.list > /dev/null \
	&& apt update \
	&& apt install gh -y

gh extension install https://github.com/nektos/gh-act

cargo binstall action-validator

echo 'deb [trusted=yes] https://repo.goreleaser.com/apt/ /' > /etc/apt/sources.list.d/goreleaser.list
apt update -y
apt install -y nfpm podman bubblewrap proot mmdebstrap
